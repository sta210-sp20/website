---
title: "Lab 01: Review R"
date: "due Tue, Jan 21 at 11:59p"
output: 
  tufte::tufte_html:
    css: "./sta210-labs.css"
    tufte_variant: "envisioned"
    highlight: pygments
    fig_height: 10
link-citations: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE,
                      warning=FALSE, 
                      message=FALSE)
```



# Introduction

```{marginfigure}
R is the name of the programming language itself and RStudio is a convenient user interface.
```

The main goal of this lab is to review the basics of R and RStudio. We will use these tools throughout this course to analyze and make conclusions from real-world data. 

```{marginfigure}
git is a version control system (like "Track Changes" features from Microsoft Word but more powerful) and GitHub is the home for your Git-based projects on the internet (like DropBox but better).
```

An additional goal is to introduce you to git and GitHub, which is the version control and collaboration system we will use throughout the course.

As the labs progress, you are encouraged to explore beyond what the labs dictate; a willingness to experiment will make you a much better programmer and statistician. This lab is a brief review of the fundamental building blocks of R and RStudio: the interface, reading in data, and basic data wrangling and graphing functions. If you're new to R or would like additional practice, there are resources listed at the end of the lab instructions. 

Today's lab will focus on fundamental building blocks of R and RStudio: the interface, reading in data, and basic commands. Starting next week, the labs will focus on concepts more specific to regression analysis. Today's lab will be individual, to give you a chance to become more familiar with the workflow. In future labs you will work in teams, and learn how to collaborate using GitHub to produce a single lab report as a team. 

## Topics covered in this lab:

- Exploratory Data Analysis (EDA) - data visualizations and numerical summaries
- Statistical inference about a mean
- Writing a lab report using R Markdown
- Tracking changes and using git and GitHub

# Getting Started

Each of your assignments will begin with steps in this section. You saw your TA demonstrate these steps, and they're outlined in detail below. Going forward, each lab will begin with a "Getting started" section but the details will become more sparse as the semester progresses. You can always refer back to this lab for a detailed list of the steps involved for getting started with an assignment.

## Clone the repo & start new project in RStudio 

- Go to the sta210-sp20 organization on GitHub (http://www.github.com/sta210-sp20). Click on the repo with the prefix **lab-01-review-r-**. It contains the starter documents you need to complete the lab.

```{r clone-repo-link, fig.margin = TRUE, echo = FALSE, fig.width=3}
knitr::include_graphics("img/01-intro-r/clone-repo-link.png")
```

- Click on the green **Clone or download** button, select **Use HTTPS** (this might already be selected by default, and if it is, you'll see the text **Clone with HTTPS** as in the image below). Click on the clipboard icon to copy the repo URL.

```{r new-project-from-gh, fig.margin = TRUE, echo = FALSE, fig.width=3, eval = F}
knitr::include_graphics("img/01-intro-r/new-project-from-gh.png")
```

- Go to https://vm-manage.oit.duke.edu/containers and login with your Duke NetId and Password.

- Click to log into the Docker container **RStudio - statistics application with RMarkdown and knitr support**. You should now see the RStudio environment. 

- Go to *File* `r emo::ji("arrow_right")` *New Project* `r emo::ji("arrow_right")` *Version Control* `r emo::ji("arrow_right")` *Git*. 

- Copy and paste the URL of your assignment repo into the dialog box *Repository URL*. You can leave the direct name empty. It will default to the name of the GitHub repo.

UPDATE THE PICTURE! 
```{r paste-gh-repo-url, fig.margin = TRUE, echo = FALSE, fig.width=5, eval = F}
knitr::include_graphics("img/01-intro-r/paste-gh-repo-url.png")
```

- Click *Create Project*, and you should see the contents from your GitHub repo in the **Files** pane in RStudio. 

## Configure git - DO WE NEED THIS WITH THE DOCKERS?

There is one more piece of housekeeping we need to take care of before we get started. Specifically,  we need to configure your git so that RStudio can communicate with GitHub. This requires two pieces of information: your name and email address.

To do so, you will use the `use_git_config()` function from the `usethis` package. 

Type the following lines of code in the **console** in RStudio filling in your name and email address.

```{marginfigure}
The email address is the one tied to your GitHub account. 
```

```{r eval=FALSE}
library(usethis)
use_git_config(user.name = "GitHub username", user.email="your email")
```

For example, mine would be 

```{r eval=FALSE}
library(usethis)
use_git_config(user.name="matackett", user.email="maria.tackett@duke.edu")
```

If you get the error message

```{r eval=FALSE}
Error in library(usethis) : there is no package called ‘usethis’
```

then you need to install the `usethis` package. Run the following code in the console to install the package.

```{r eval=FALSE}
install.package("usethis")
```

Once you run the code, your values for `user.name` and `user.email` will show in the console. If your `user.name` and `user.email` are correct, you're good to go! Otherwise, run the code again with the necessary changes.

## THE RSTUDIO PROJECT

- PICTURES AND DESCRIPTION OF WHAT EACH PART OF RSTUDIO PROJECT PANE IS


## Packages

We will use the following packages in today's lab. 

```{r load-packages}
library(tidyverse)
```

If you need to install the package, you can run the code below in the **console**.

```{r,eval=F}
install.packages("tidyverse") 
```

## YAML 

Before we introduce the data, let's update the name and date in the YAML. 

```{marginfigure}
The top portion of your R Markdown file (between the three dashed lines) is called YAML. It stands for "YAML Ain't Markup Language". It is a human friendly data serialization standard for all programming languages. All you need to know is that this area is called the YAML (we will refer to it as such) and that it contains meta information about your document.
```

Open the R Markdown (Rmd) file in your project, input your name for the author name and today's date for the date, and knit the document.

**UPDATE PICTURE**

```{r yaml-raw-to-rendered, echo = FALSE}
knitr::include_graphics("img/01-intro-r/yaml-raw-to-rendered.png")
```

**WRITE SOMETHING ABOUT THE FILE TYPES THAT WE'LL USE**

## Committing changes:

Then go to the Git pane in your RStudio.

If you have made changes to your Rmd file, you should see it listed here. Click on it to select it in this list and then click on **Diff**. This shows you the difference between the last committed state of the document and its current state with your changes. If you're happy with these changes, write "Update author name" in the **Commit message** box and click **Commit**.

**UPDATE PICTURE**

```{r update-author-name-commit, echo = FALSE}
knitr::include_graphics("img/01-intro-r/update-author-name-commit.png")
```

You don't have to commit after every change, this would get quite cumbersome. You should consider committing states that are *meaningful to you* for inspection, comparison, or restoration. In the first few assignments we will tell you exactly when to commit and in some cases, what commit message to use. As the semester progresses we will let you make these decisions.

## Pushing changes: 

Now that you have made an update and committed this change, it's time to push these changes to the web! Or more specifically, to your repo on GitHub. Why? So that others can see your changes. And by others, we mean the course teaching team (your repos in this course are private to you and us, only). 

In order to push your changes to GitHub, click on **Push**. This will prompt a dialogue box where you first need to enter your user name, and then your password. This might feel cumbersome. Bear with me... We *will* teach you how to save your password so you don't have to enter it every time. But for this one assignment you'll have to manually enter each time you push in order to gain some experience with it.


## Data: Trails in Durham, NC

Today's data comes from the [Durham Open Data](https://live-durhamnc.opendata.arcgis.com/) a program managed by the City of Durham's Technology Solutions Department and the County of Durham's Information Services & Technology Department to provide open data about our community. You can read more about their mission [here](https://live-durhamnc.opendata.arcgis.com/pages/about-us).

In this lab, we will focus on data about the proposed and existing outdoor trails in Durham, NC. The data is located in the *durham_trails.csv* file located in the *data* folder. Use the code below to read in the .csv file and save it in the RStudio environment as a data frame called `trails`.

```{r read-data, eval=FALSE}
trails <- read_csv("data/durham_trails.csv")
```

A full list of the variables in the dataset can be found [here](https://live-durhamnc.opendata.arcgis.com/datasets/existing-and-proposed-trails?geometry=-80.283%2C35.650%2C-77.473%2C36.428). For today's analysis, we will primarily focus on the following variables: 



|  |  |
|----------|-------|
| `status` |Whether the trail is proposed or existing|
| `dogwalking` | Whether dogs are allowed on the trail |
| `length` | Length of the trail in miles |

# Exercises  

Before doing any analysis, we may want to get quick view of the data. This is a useful thing to do after importing data to get an intial idea of the data imported correctly. One way to do this, is to look at the actual dataset. Type the code below in the **console** to view the entire dataset. 

```{r eval=FALSE}
View(trails)
```

```{marginfigure}
Notice that the `View(trails)` command was run in the console and **not** in a code chunk in the RMarkdown file. By running the `View(trails)`, the dataset displays in your RStudio environment but not in the output from your RMarkdown file. Unless your dataset is very small (i.e. 20 observations or fewer), you never want to output the entire dataset in the output from the RMarkdown file. It is very disruptive if there are hundres (or thousands) of rows of data printed amongst your code, analysis output and narrative.
```

## Exploratory Data Analysis

1. It is sometimes more useful to view a summary of the data structure rather than view the entire dataset. This is especially true for very large datasets, i.e. those with a very large number of observations and/or rows. We can use the `glimpse()` function to get a general idea about the structure of our dataset. This function can be very useful when importing data from a file such as a .csv file (like in this lab) to ensure that data imported correctly and that we have the number of observations (rows) and variables (columns) we expect. We can also use this function to see each variable's type (e.g. integer, character). 

    Use the `glimpse` function to get an overview of `trails`.

```{r eval = F}
glimpse(trails)
```

```{marginfigure}
Type `??glimpse` in the console to learn more about the function and its syntax.
```


How many observations (rows) are in the `trails` dataset? How many variables (columns)?

2. Before conducting statistical inference (or eventually fitting regression models),  we want to do an exploratory data analysis (EDA) to get a sense of the main characteristics of the data. Much of EDA consists of visualizing the data but it also includes calculating summary statistics for the variables in our dataset. It is important to examine all variables relevant to the analysis (even if they are not included in the model), so you have full context about the data when interpreting the results. 

<!-- This dataset contains information for both existing and proposed trails.  Because There are many ways to calculate summary statistics for each variable, and we will use a few of them throughout the semester. For now, let's use the `skim()` function to calculate basic measures of center and spread. -->

Let's examine the distribution of `status` with a data visulization and summary statistics. 

- What is an appropriate type of plot to visualize the distribution of `status`? Fill in the `ggplot` code below to plot the distribution of `status`. Include informative axis labels and title on the graph.

```{r eval=FALSE}
ggplot(data = trails, aes(x = status)) + 
  __________ + 
  labs(x = "_________", 
       y = "_________", 
       title = "__________")
```

```{marginfigure}
See [Section 7.3.1 "Visualising Distributions"](https://r4ds.had.co.nz/exploratory-data-analysis.html#introduction-3) in *R for Data Science* for more information on choosing the appropriate graph based on variable type.
```

Next, let's make a table of values in each category of `status`. Use the `count` function to display the number of observations in each category of `status`. Be sure to show your code and output. 


3. The goal of the analysis is understand characteristics about trails in Durham, so we will just use data from currently existing trails for the analysis. Fill in the code below to use the `filter` function to create a subset of the data containing only the trails that are currently existing. Assign this subset the name `current_trails`. 

```{r eval = FALSE}
current_trails <- trails %>%
  filter(__________)
```

*This is a good place to knit, commit, and push changes to your remote lab-01 repo on GitHub. Be sure to write informative commit message (e.g. "Completed exercises 1 - 3"), and push every file to GitHub by clicking the checkbox next to each file in the Git pane. After you push the changes, the Git pane in RStudio should be empty."*

```{marginfigure}
Check your lab-01 repo on the GitHub website (you may need to refresh the page in your browser) to ensure that all of the files are up-to-date.
```

**Use `current_trails` for the remainder of the lab.**

4. Let's examine the distribution of `length`. One important part of EDA is visualizing the data to get a better idea of the shape of the distribution for each variable. Data visualizations are also useful for examining the relationship between multiple variables.  There are a lot of ways to make plots in R; we will use the functions available in the `ggplot2` package.

Use  `geom_histogram()` to visualize the distribution of `length`. Include informative axis labels and title on the graph.

```{marginfigure}
See [Section 7.3.1 "Visualising Distributions"](https://r4ds.had.co.nz/exploratory-data-analysis.html#introduction-3) or the [ggplot2 Reference page](https://ggplot2.tidyverse.org/reference/index.html) for details and example code.
```                                               

5. Next, fill in the code below to use the `summarise` function to calculate various summary statistics for the variable `length`. You can use the [summarise reference page](https://dplyr.tidyverse.org/reference/summarise.html) for more information about the function and example code. 

```{r eval = FALSE}
current_trails %>%
  summarise(min = __________, 
            q1 = __________, 
            median = __________, 
            q3 = __________, 
            max = __________, 
            iqr = __________, 
            mean = __________, 
            std_dev = __________
            )
```


6. What are the appropriate measures of center and spread to describe the distribution of `length`. Briefly explain your reasoning. 

7. Describe the distribution of `length`. Your description should include comments about the sahpe, center, spread, and any potential outliers. Use the histogram and appropriate summary statistics (from Exercise 6) in your description. 

*This is a good place to knit, commit, and push changes to your remote lab-01 repo on GitHub. Be sure to write informative commit message (e.g. "Completed exercises 4 - 7"), and push every file to GitHub by clicking the checkbox next to each file in the Git pane. After you push the changes, the Git pane in RStudio should be empty."*

8. Consider the distribution of `dogwalking`. What is likely the true value of `dogwalking` for observations with `NA` recorded in the dataset? Fill in the code below to impute the appropriate value of `dogwalking` for observations currently listed as `NA`. Then, display the distribution of `dogwalking` to check that the missing values were correctly imputed.

```{r eval=FALSE}
current_trails <- current_trails %>%
  mutate(dogwalking = if_else(is.na(dogwalking),______,dogwalking))
```

9. Let's examine the relationship between the length of the trail and whether dog walking is allowed. Make an appropriate graph and calculate the appropriate summary statistics to describe the relationship between `length` and `dogwalking`. Be sure to include informative axis labels and title on your graph.

10. Describe the relationship between `length` and `dogwalking`. Include information from the graph and summary statistics from the previous exercise in your description. 


*This is a good place to knit, commit, and push changes to your remote lab-01 repo on GitHub. Be sure to write informative commit message (e.g. "Completed exercises 8 - 10"), and push every file to GitHub by clicking the checkbox next to each file in the Git pane. After you push the changes, the Git pane in RStudio should be empty."*


## Statistical Inference

We'd like to use the data from the trails in Durham to make more general conclusions about trails in urban areas in the southeast of the United States. For the purposes of this lab, then, we will consider the trails in Durham a sample representative of the trails in other urbran areas in states in the Southeast United States.

11. Discussion about the assumptions.

11. While we have observed a difference in the mean length in trails for those that allow dog-walking versus those that don't, let's assess whether that difference is statistically signifcant or just due to random chance. We'll begin by conducting a hypothesis test: 
      -  State the null and alternative hypotheses in words.
      -  Now write the hypotheses in statistical notation. You can use "mu" to represent the mean parameter.

12. Fill in the code below to use the `t.test` function to calculate the test statistic and p-value. Replace `response` with the variable we're interesting in analyzing and `group_var` with the variable used to define the two groups.

```{r eval = FALSE}
t.test(response ~ group_var, data = current_trails, 
       alternative = "___________", 
       conf.level = 0.99) #less, greater, or two.sided
```

```{marginfigure}
Type `?t.test` in the console to learn more about the function and its options. 
```

13. Use the output from the previous exercise to answer the following: 
  - Write the definition of the test statistic in the context of this analysis.
  - Write the definition of the p-value in the context of this analysis. 
  - State your conclusion in the context of this analysis. Use $\alpha = 0.01$ for the significance level.  significance level.  

14. Notice the confidence interval for the difference in mean trail length printed in the output from Exercise 12. Interpret this confidence interval in the context of this analysis. 


*You're done! Knit, commit, and push all remaining changes. You can use the commit message "Done with Lab 1!" Before you wrap up the assignment, make sure you have pushed all the files to GitHub (your Git pane in RStudio should be empty) and that<u>all</u> documents are updated in your repo on GitHub.*

## Resources for additional practice (optional)

- [Chapter 2: Get Started](https://socviz.co/gettingstarted.html#work-in-plain-text-using-rmarkdown) *Data Visualization by Kieran Healy* 

- [Chapter 3: Data visualization](https://r4ds.had.co.nz/data-visualisation.html) in *R for Data Science* by Hadley Wickham

- RStudio Cloud Primers
  - Visualization Basics: https://rstudio.cloud/learn/primers/1.1
  - Work with Data: https://rstudio.cloud/learn/primers/2
  - Visualize Data: https://rstudio.cloud/learn/primers/3

- Visualization in R using ggplot2 workshop by the Center for Data and Visualization Sciences 
  - Jan 30, 1p - 3p
  - More info & registration: https://duke.libcal.com/event/6085379
  
<br><br>
<hr>

<div class = "footer">
This work is licensed under the [Creative Commons Attribution-NonCommercial-ShareAlike 4.0 International License](https://creativecommons.org/licenses/by-nc-sa/4.0/).
</div>
